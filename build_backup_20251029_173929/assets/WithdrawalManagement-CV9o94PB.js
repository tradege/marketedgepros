var e=(e,a,s)=>new Promise((t,l)=>{var r=e=>{try{n(s.next(e))}catch(a){l(a)}},d=e=>{try{n(s.throw(e))}catch(a){l(a)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,d);n((s=s.apply(e,a)).next())});import{j as a,h as s,a as t,d as l}from"./index-CyU3HRDM.js";import{b as r}from"./react-vendor-DvHQdeg3.js";import{S as d}from"./search-D_57Sg3B.js";import{C as n,a as i,b as o}from"./chevrons-right-C_igKcZ6.js";import{C as c}from"./chevron-right-D67x42FG.js";import{C as m}from"./clock-NsV-XnwU.js";import{D as x}from"./dollar-sign-D1_bh2C4.js";import{D as h}from"./download-BbIbXbME.js";import{E as p}from"./eye-DSFnrrMC.js";import"./utils-BQl1bh9w.js";function u({columns:e,data:s,pageSize:t=10,searchable:l=!1,onRowClick:m,loading:x=!1}){const[h,p]=r.useState(1),[u,b]=r.useState(""),g=Array.isArray(s)?s:[],j=l&&u?g.filter(e=>Object.values(e).some(e=>String(e).toLowerCase().includes(u.toLowerCase()))):g,v=Math.ceil(j.length/t),y=(h-1)*t,w=y+t,N=j.slice(y,w),f=e=>{p(Math.max(1,Math.min(e,v)))};return x?a.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-white/10 rounded-2xl overflow-hidden",children:a.jsx("div",{className:"p-6 space-y-4",children:[...Array(5)].map((e,s)=>a.jsx("div",{className:"h-12 bg-slate-700/50 rounded animate-pulse"},s))})}):a.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-white/10 rounded-2xl overflow-hidden",children:[l&&a.jsx("div",{className:"p-4 border-b border-white/10",children:a.jsxs("div",{className:"relative",children:[a.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search...",value:u,onChange:e=>{b(e.target.value),p(1)},className:"w-full pl-10 pr-4 py-2 bg-slate-900/50 border border-white/10 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsx("tr",{className:"border-b border-white/10 bg-slate-900/30",children:e.map((e,s)=>a.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider",children:e.headerName||e.field},s))})}),a.jsx("tbody",{className:"divide-y divide-white/5",children:0===N.length?a.jsx("tr",{children:a.jsx("td",{colSpan:e.length,className:"px-6 py-12 text-center text-gray-400",children:"No data available"})}):N.map((s,t)=>a.jsx("tr",{onClick:()=>m&&m(s),className:`\n                    transition-colors duration-200\n                    ${m?"cursor-pointer hover:bg-slate-700/30":""}\n                  `,children:e.map((e,t)=>a.jsx("td",{className:"px-6 py-4 text-sm text-gray-300",children:e.render?e.render(s[e.field],s):s[e.field]},t))},t))})]})}),v>1&&a.jsxs("div",{className:"px-6 py-4 border-t border-white/10 flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",y+1," to ",Math.min(w,j.length)," of"," ",j.length," results"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>f(1),disabled:1===h,className:"p-2 rounded-lg border border-white/10 text-gray-400 hover:bg-slate-700/30 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a.jsx(n,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>f(h-1),disabled:1===h,className:"p-2 rounded-lg border border-white/10 text-gray-400 hover:bg-slate-700/30 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a.jsx(i,{className:"w-4 h-4"})}),a.jsx("div",{className:"flex items-center gap-1",children:[...Array(v)].map((e,s)=>{const t=s+1;return 1===t||t===v||t>=h-1&&t<=h+1?a.jsx("button",{onClick:()=>f(t),className:`\n                        min-w-[40px] px-3 py-2 rounded-lg text-sm font-medium transition-all\n                        ${h===t?"bg-gradient-to-r from-cyan-500 to-teal-500 text-white":"border border-white/10 text-gray-400 hover:bg-slate-700/30 hover:text-white"}\n                      `,children:t},t):t===h-2||t===h+2?a.jsx("span",{className:"px-2 text-gray-400",children:"..."},t):null})}),a.jsx("button",{onClick:()=>f(h+1),disabled:h===v,className:"p-2 rounded-lg border border-white/10 text-gray-400 hover:bg-slate-700/30 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a.jsx(c,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>f(v),disabled:h===v,className:"p-2 rounded-lg border border-white/10 text-gray-400 hover:bg-slate-700/30 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a.jsx(o,{className:"w-4 h-4"})})]})]})]})}function b(){var d,n,i;const[o,c]=r.useState([]),[b,g]=r.useState(!0),[j,v]=r.useState("all"),[y,w]=r.useState(!1),[N,f]=r.useState(null),[k,C]=r.useState(!1);r.useEffect(()=>{A()},[j]);const A=()=>e(null,null,function*(){var e;try{g(!0);const a="all"!==j?{status:j}:{},t=yield s.get("/wallet/admin/withdrawals",{params:a});console.log("WithdrawalManagement API Response:",t),console.log("Response data:",t.data),console.log("Response data type:",typeof t.data),console.log("Withdrawals:",null==(e=t.data)?void 0:e.withdrawals),t.data&&t.data.withdrawals?c(t.data.withdrawals):Array.isArray(t.data)?c(t.data):c([])}catch(a){console.error("WithdrawalManagement Error:",a),console.error("Error response:",a.response),c([])}finally{g(!1)}}),S=e=>a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${{pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",processing:"bg-purple-100 text-purple-800",completed:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[e]||"bg-slate-700/50 text-gray-100"}`,children:e.charAt(0).toUpperCase()+e.slice(1)}),F=[{key:"id",label:"ID",render:e=>`#${e.id}`},{key:"user",label:"User",render:e=>{var s,t;return a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:(null==(s=e.user)?void 0:s.name)||"N/A"}),a.jsx("div",{className:"text-sm text-gray-400",children:(null==(t=e.user)?void 0:t.email)||"N/A"})]})}},{key:"amount",label:"Amount",render:e=>a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:["$",parseFloat(e.amount).toFixed(2)]}),e.fee>0&&a.jsxs("div",{className:"text-xs text-gray-400",children:["Fee: $",parseFloat(e.fee).toFixed(2)]})]})},{key:"payment_method",label:"Method",render:e=>{var s;return a.jsx("span",{className:"capitalize",children:null==(s=e.payment_method)?void 0:s.replace("_"," ")})}},{key:"status",label:"Status",render:e=>S(e.status)},{key:"created_at",label:"Requested",render:e=>new Date(e.created_at).toLocaleDateString()},{key:"actions",label:"Actions",render:e=>a.jsx("button",{onClick:()=>{f(e),w(!0)},className:"text-blue-600 hover:text-blue-800 font-medium",children:a.jsx(p,{className:"w-5 h-5"})})}],$=[{label:"Total Pending",value:(o||[]).filter(e=>"pending"===e.status).length,icon:m,color:"yellow"},{label:"Total Amount Pending",value:`$${(o||[]).filter(e=>"pending"===e.status).reduce((e,a)=>e+parseFloat(a.amount),0).toFixed(2)}`,icon:x,color:"blue"},{label:"Completed Today",value:(o||[]).filter(e=>"completed"===e.status&&new Date(e.completed_at).toDateString()===(new Date).toDateString()).length,icon:t,color:"green"},{label:"Rejected",value:(o||[]).filter(e=>"rejected"===e.status).length,icon:l,color:"red"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-white",children:"Withdrawal Management"}),a.jsx("p",{className:"mt-2 text-gray-300",children:"Manage and process withdrawal requests"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:$.map((e,s)=>{const t=e.icon;return a.jsx("div",{className:"bg-slate-800/50 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-300",children:e.label}),a.jsx("p",{className:"text-2xl font-bold mt-1",children:e.value})]}),a.jsx("div",{className:`p-3 rounded-lg ${{yellow:"bg-yellow-100 text-yellow-600",blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",red:"bg-red-100 text-red-600"}[e.color]}`,children:a.jsx(t,{className:"w-6 h-6"})})]})},s)})}),a.jsx("div",{className:"bg-slate-800/50 rounded-lg shadow p-4",children:a.jsx("div",{className:"flex gap-2",children:["all","pending","approved","processing","completed","rejected"].map(e=>a.jsx("button",{onClick:()=>v(e),className:"px-4 py-2 rounded-lg font-medium transition-colors "+(j===e?"bg-blue-600 text-white":"bg-slate-700/50 text-gray-200 hover:bg-slate-700"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})}),a.jsx("div",{className:"bg-slate-800/50 rounded-lg shadow",children:a.jsx(u,{columns:F,rows:o||[]})}),y&&N&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-slate-800/50 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Withdrawal Details"}),a.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-300",children:"âœ•"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-b pb-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"User Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-300",children:"Name:"}),a.jsx("span",{className:"ml-2 font-medium",children:(null==(d=N.user)?void 0:d.name)||"N/A"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-300",children:"Email:"}),a.jsx("span",{className:"ml-2 font-medium",children:(null==(n=N.user)?void 0:n.email)||"N/A"})]})]})]}),a.jsxs("div",{className:"border-b pb-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Amount Details"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-300",children:"Gross Amount:"}),a.jsxs("span",{className:"ml-2 font-medium",children:["$",parseFloat(N.amount).toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-300",children:"Fee:"}),a.jsxs("span",{className:"ml-2 font-medium",children:["$",parseFloat(N.fee||0).toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-300",children:"Net Amount:"}),a.jsxs("span",{className:"ml-2 font-medium text-green-600",children:["$",parseFloat(N.net_amount||N.amount).toFixed(2)]})]})]})]}),a.jsxs("div",{className:"border-b pb-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Payment Information"}),a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-300",children:"Method:"}),a.jsx("span",{className:"ml-2 font-medium capitalize",children:null==(i=N.payment_method)?void 0:i.replace("_"," ")})]}),N.payment_details&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-300",children:"Details:"}),a.jsx("pre",{className:"ml-2 mt-1 p-2 bg-slate-900 rounded text-xs",children:JSON.stringify(N.payment_details,null,2)})]})]})]}),a.jsxs("div",{className:"border-b pb-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Status"}),a.jsxs("div",{className:"flex items-center gap-2",children:[S(N.status),a.jsxs("span",{className:"text-sm text-gray-300",children:["Requested: ",new Date(N.created_at).toLocaleString()]})]}),N.rejection_reason&&a.jsxs("div",{className:"mt-2 p-3 bg-red-50 rounded",children:[a.jsx("span",{className:"text-sm font-medium text-red-800",children:"Rejection Reason:"}),a.jsx("p",{className:"text-sm text-red-700 mt-1",children:N.rejection_reason})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:["pending"===N.status&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{return a=N.id,e(null,null,function*(){var e,t;if(confirm("Are you sure you want to approve this withdrawal?"))try{C(!0),yield s.post(`/wallet/admin/withdrawals/${a}/approve`),alert("Withdrawal approved successfully"),A(),w(!1)}catch(l){alert((null==(t=null==(e=l.response)?void 0:e.data)?void 0:t.error)||"Failed to approve withdrawal")}finally{C(!1)}});var a},disabled:k,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium",children:[a.jsx(t,{className:"w-5 h-5 inline mr-2"}),"Approve"]}),a.jsxs("button",{onClick:()=>{return a=N.id,e(null,null,function*(){var e,t;const l=prompt("Please provide a reason for rejection:");if(l)try{C(!0),yield s.post(`/wallet/admin/withdrawals/${a}/reject`,{reason:l}),alert("Withdrawal rejected successfully"),A(),w(!1)}catch(r){alert((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||"Failed to reject withdrawal")}finally{C(!1)}});var a},disabled:k,className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 font-medium",children:[a.jsx(l,{className:"w-5 h-5 inline mr-2"}),"Reject"]})]}),("approved"===N.status||"processing"===N.status)&&a.jsxs("button",{onClick:()=>{return a=N.id,e(null,null,function*(){var e,t;const l=prompt("Please enter the transaction ID:");if(l)try{C(!0),yield s.post(`/wallet/admin/withdrawals/${a}/complete`,{transaction_id:l}),alert("Withdrawal marked as completed"),A(),w(!1)}catch(r){alert((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||"Failed to complete withdrawal")}finally{C(!1)}});var a},disabled:k,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium",children:[a.jsx(h,{className:"w-5 h-5 inline mr-2"}),"Mark as Completed"]})]})]})]})})})]})}export{b as default};
