var e=(e,t,a)=>new Promise((s,r)=>{var l=e=>{try{o(a.next(e))}catch(t){r(t)}},i=e=>{try{o(a.throw(e))}catch(t){r(t)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(l,i);o((a=a.apply(e,t)).next())});import{j as t,a}from"./index-K1_PuWBv.js";import{u as s,b as r}from"./react-vendor-DvHQdeg3.js";import{u as l}from"./notificationStore-CPq_xSBs.js";import i from"./UserLayout-Df_w1cXb.js";import{S as o}from"./settings-BTQkRYGX.js";import{L as n}from"./loader-DBdOUcWI.js";import{T as d}from"./trash-2-DFvBw5wY.js";import"./utils-BQl1bh9w.js";function c(e,t={}){const a=new Date,s=Math.floor((a-e)/1e3);if(s<60)return t.addSuffix?"just now":"less than a minute";const r=Math.floor(s/60);if(r<60){const e=1===r?"1 minute":`${r} minutes`;return t.addSuffix?`${e} ago`:e}const l=Math.floor(r/60);if(l<24){const e=1===l?"1 hour":`${l} hours`;return t.addSuffix?`${e} ago`:e}const i=Math.floor(l/24);if(i<30){const e=1===i?"1 day":`${i} days`;return t.addSuffix?`${e} ago`:e}const o=Math.floor(i/30);if(o<12){const e=1===o?"1 month":`${o} months`;return t.addSuffix?`${e} ago`:e}const n=Math.floor(o/12),d=1===n?"1 year":`${n} years`;return t.addSuffix?`${d} ago`:d}const m=e=>{const t={low:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",normal:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",high:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",urgent:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};return t[e]||t.normal};function x(){const x=s(),[h,u]=r.useState("all"),{notifications:p,loading:b,currentPage:f,totalPages:g,fetchNotifications:w,markAsRead:y,markAllAsRead:v,deleteNotification:j}=l();r.useEffect(()=>{const e={};"unread"===h?e.is_read="false":"all"!==h&&(e.type=h),w(1,e)},[h,w]);const N=e=>{const t={};"unread"===h?t.is_read="false":"all"!==h&&(t.type=h),w(e,t)};return t.jsx(i,{children:t.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[t.jsx("h1",{className:"text-3xl font-bold text-white",children:"Notifications"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{onClick:()=>e(null,null,function*(){yield v()}),disabled:0===p.length,className:"flex items-center gap-2 px-4 py-2 border border-white/20 text-white rounded-lg hover:bg-white/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(a,{className:"w-4 h-4"}),"Mark All Read"]}),t.jsxs("button",{onClick:()=>x("/settings/notifications"),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-purple-800 text-white rounded-lg hover:from-purple-700 hover:to-purple-900 transition-colors",children:[t.jsx(o,{className:"w-4 h-4"}),"Settings"]})]})]}),t.jsx("div",{className:"mb-6 bg-slate-800/50 backdrop-blur-sm border border-white/10 rounded-lg p-1",children:t.jsx("div",{className:"flex gap-1 overflow-x-auto",children:[{label:"All",value:"all"},{label:"Unread",value:"unread"},{label:"Withdrawals",value:"withdrawal"},{label:"Commissions",value:"commission"},{label:"KYC",value:"kyc"},{label:"Payments",value:"payment"},{label:"Challenges",value:"challenge"},{label:"System",value:"system"}].map(e=>t.jsx("button",{onClick:()=>(e=>{u(e)})(e.value),className:"px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-colors "+(h===e.value?"bg-gradient-to-r from-purple-600 to-purple-800 text-white":"text-gray-300 hover:text-white hover:bg-white/5"),children:e.label},e.value))})}),t.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-white/10 rounded-lg",children:b?t.jsx("div",{className:"flex justify-center p-12",children:t.jsx(n,{className:"w-8 h-8 text-purple-500 animate-spin"})}):0===p.length?t.jsx("div",{className:"p-12 text-center",children:t.jsx("p",{className:"text-gray-400",children:"No notifications found"})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"divide-y divide-white/5",children:p.map(a=>{return t.jsxs("div",{onClick:()=>(t=>e(null,null,function*(){t.is_read||(yield y(t.id)),"withdrawal"===t.type?x("/trader/withdrawals"):"commission"===t.type?x("/agent/commissions"):"kyc"===t.type&&x("/kyc")}))(a),className:"flex items-start gap-4 p-4 cursor-pointer transition-colors "+(a.is_read?"hover:bg-white/5":"bg-white/10 hover:bg-white/15"),children:[t.jsx("div",{className:"text-3xl flex-shrink-0 mt-1",children:(s=a.type,{withdrawal:"ðŸ’°",commission:"ðŸ’µ",kyc:"ðŸ†”",system:"ðŸ“¢",payment:"ðŸ’³",challenge:"ðŸŽ¯"}[s]||"ðŸ“¬")}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h3",{className:"text-base "+(a.is_read?"text-gray-300":"text-white font-semibold"),children:a.title}),t.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${m(a.priority)}`,children:a.priority}),!a.is_read&&t.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-blue-500"})]}),t.jsx("p",{className:"text-sm text-gray-400 mb-1",children:a.message}),t.jsx("p",{className:"text-xs text-gray-500",children:c(new Date(a.created_at),{addSuffix:!0})})]}),t.jsx("button",{onClick:t=>((t,a)=>e(null,null,function*(){t.stopPropagation(),yield j(a)}))(t,a.id),className:"flex-shrink-0 p-2 text-gray-400 hover:text-red-400 transition-colors",children:t.jsx(d,{className:"w-5 h-5"})})]},a.id);var s})}),g>1&&t.jsxs("div",{className:"flex justify-center gap-2 p-4 border-t border-white/10",children:[t.jsx("button",{onClick:()=>N(f-1),disabled:1===f,className:"px-4 py-2 border border-white/20 text-white rounded-lg hover:bg-white/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),t.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:g},(e,t)=>t+1).map(e=>t.jsx("button",{onClick:()=>N(e),className:"w-10 h-10 rounded-lg transition-colors "+(f===e?"bg-gradient-to-r from-purple-600 to-purple-800 text-white":"border border-white/20 text-gray-300 hover:bg-white/10"),children:e},e))}),t.jsx("button",{onClick:()=>N(f+1),disabled:f===g,className:"px-4 py-2 border border-white/20 text-white rounded-lg hover:bg-white/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})})]})})}export{x as default};
