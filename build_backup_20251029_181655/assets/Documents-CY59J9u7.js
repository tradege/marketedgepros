var e=(e,t,r)=>new Promise((s,a)=>{var l=e=>{try{n(r.next(e))}catch(t){a(t)}},d=e=>{try{n(r.throw(e))}catch(t){a(t)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(l,d);n((r=r.apply(e,t)).next())});import{h as t,j as r,a as s}from"./index-C96smR-l.js";import{b as a}from"./react-vendor-DvHQdeg3.js";import l from"./UserLayout-UzXPgSCT.js";import{L as d}from"./loader-BltbU-aa.js";import{F as n}from"./file-text-GsYqaQBc.js";import{U as i}from"./upload-B9Qb50YR.js";import"./utils-BQl1bh9w.js";function o(){const[o,c]=a.useState([]),[p,x]=a.useState(null),[m,u]=a.useState("not_submitted"),[g,h]=a.useState(!0),[b,y]=a.useState(null),[f,j]=a.useState(null),v=[{type:"id_proof",label:"ID Proof",description:"Government-issued ID (Passport, Driver License, National ID)",required:!0},{type:"address_proof",label:"Address Proof",description:"Utility bill, bank statement (not older than 3 months)",required:!0},{type:"selfie",label:"Selfie with ID",description:"Clear photo of yourself holding your ID",required:!0},{type:"bank_statement",label:"Bank Statement",description:"Recent bank statement for withdrawal verification",required:!1}];a.useEffect(()=>{N()},[]);const N=()=>e(null,null,function*(){var e,r;try{h(!0),j(null);const e=yield t.get("/kyc/documents");c(e.data.documents||[]),x(e.data.statistics||{}),u(e.data.overall_status||"not_submitted")}catch(s){j((null==(r=null==(e=s.response)?void 0:e.data)?void 0:r.error)||"Failed to load documents")}finally{h(!1)}}),k=(r,s)=>e(null,null,function*(){var e,a;const l=s.target.files[0];if(!l)return;if(["image/jpeg","image/png","image/jpg","application/pdf"].includes(l.type))if(l.size>5242880)j("File size must be less than 5MB");else try{y(r);const e=new FormData;e.append("file",l),yield t.post(`/kyc/documents/${r}/upload`,e,{headers:{"Content-Type":"multipart/form-data"}}),yield N(),j(null)}catch(d){j((null==(a=null==(e=d.response)?void 0:e.data)?void 0:a.error)||"Failed to upload document. Please try again.")}finally{y(null)}else j("Please upload a valid file (JPG, PNG, or PDF)")}),w=(null==p?void 0:p.approved)===v.filter(e=>e.required).length;return g?r.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:r.jsx(d,{className:"w-8 h-8 text-purple-500 animate-spin"})}):r.jsx(l,{children:r.jsxs("div",{children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Documents & Verification"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Upload your documents for account verification"})]}),f&&r.jsx("div",{className:"mb-6 p-4 bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-400 rounded-lg",children:f}),r.jsxs("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Verification Status"}),w&&r.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-full text-sm font-semibold",children:[r.jsx(s,{className:"w-4 h-4"}),"Fully Verified"]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Required Documents"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:(null==p?void 0:p.total)||0})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Approved"}),r.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:(null==p?void 0:p.approved)||0})]}),r.jsxs("div",{className:"text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Pending Review"}),r.jsx("p",{className:"text-3xl font-bold text-yellow-600 dark:text-yellow-400",children:(null==p?void 0:p.pending)||0})]}),r.jsxs("div",{className:"text-center p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Rejected"}),r.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:(null==p?void 0:p.rejected)||0})]})]}),!w&&r.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[r.jsx("p",{className:"text-sm font-semibold text-blue-900 dark:text-blue-200 mb-1",children:"Action Required"}),r.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:"Please upload all required documents to complete your account verification."})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:v.map(e=>{(e=>{const t=o.find(t=>t.type===e);t&&t.status})(e.type);const t=(s=e.type,o.find(e=>e.type===s));var s;return r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[r.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/20 rounded-lg flex items-center justify-center flex-shrink-0",children:r.jsx(n,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[e.label,e.required&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.description})]})]}),t&&"not_uploaded"!==t.status?r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),t.uploaded_at&&r.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Uploaded: ",new Date(t.uploaded_at).toLocaleDateString()]})]}),r.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded ${getStatusColor(docInfo.status)}",children:t.status})]}),t.notes&&r.jsx("div",{className:"p-3 rounded-lg mb-3 ${\n                        docInfo.status === 'rejected'\n                          ? 'bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800'\n                          : 'bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800'\n                      }",children:r.jsxs("p",{className:"text-sm ${\n                          docInfo.status === 'rejected'\n                            ? 'text-red-800 dark:text-red-300'\n                            : 'text-blue-800 dark:text-blue-300'\n                        }",children:[r.jsx("strong",{children:"Note:"})," ",t.notes]})}),"rejected"===t.status&&r.jsxs("label",{className:"flex items-center justify-center gap-2 w-full px-4 py-2 bg-gradient-to-r from-purple-600 to-purple-800 text-white rounded-lg hover:from-purple-700 hover:to-purple-900 transition-colors cursor-pointer ${\n                        uploadingType === docType.type ? 'opacity-50 cursor-not-allowed' : ''\n                      }",children:[b===e.type?r.jsxs(r.Fragment,{children:[r.jsx(d,{className:"w-5 h-5 animate-spin"}),"Uploading..."]}):r.jsxs(r.Fragment,{children:[r.jsx(i,{className:"w-5 h-5"}),"Re-upload Document"]}),r.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:t=>k(e.type,t),disabled:b===e.type,className:"hidden"})]})]}):r.jsxs("label",{className:"flex items-center justify-center gap-2 w-full px-4 py-2 bg-gradient-to-r from-purple-600 to-purple-800 text-white rounded-lg hover:from-purple-700 hover:to-purple-900 transition-colors cursor-pointer ${\n                    uploadingType === docType.type ? 'opacity-50 cursor-not-allowed' : ''\n                  }",children:[b===e.type?r.jsxs(r.Fragment,{children:[r.jsx(d,{className:"w-5 h-5 animate-spin"}),"Uploading..."]}):r.jsxs(r.Fragment,{children:[r.jsx(i,{className:"w-5 h-5"}),"Upload Document"]}),r.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:t=>k(e.type,t),disabled:b===e.type,className:"hidden"})]})]},e.type)})})]})})}export{o as default};
