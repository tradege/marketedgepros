var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,n=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&o(e,s,t[s]);if(a)for(var s of a(t))r.call(t,s)&&o(e,s,t[s]);return e},d=(e,a)=>t(e,s(a)),i=(e,t,s)=>new Promise((a,l)=>{var r=e=>{try{n(s.next(e))}catch(t){l(t)}},o=e=>{try{n(s.throw(e))}catch(t){l(t)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,o);n((s=s.apply(e,t)).next())});import{u as c,j as u,X as x}from"./index-BDL4ZnkK.js";import{b as p}from"./react-vendor-DvHQdeg3.js";import{a as m}from"./utils-BQl1bh9w.js";import{S as g}from"./search-D3taNnrN.js";import{P as h}from"./plus-Db7u5fn-.js";import{E as b}from"./eye-off-DlC7xAdB.js";import{E as f}from"./eye-CFTilG-6.js";import{P as y}from"./pen-DFs_U4Vu.js";import{T as j}from"./trash-2-DzZiw1kk.js";import{S as v}from"./save-CySYyDAh.js";const N="https://marketedgepros.com/api/v1";function w(){const{user:e}=c(),[t,s]=p.useState([]),[a,l]=p.useState(!0),[r,o]=p.useState(""),[w,k]=p.useState("all"),[C,S]=p.useState("all"),[P,E]=p.useState(!1),[$,A]=p.useState(null),[B,L]=p.useState({title:"",slug:"",excerpt:"",content:"",category:"Education",tags:"",status:"draft",featured:!1});p.useEffect(()=>{O()},[]);const O=()=>i(null,null,function*(){try{l(!0);const e=localStorage.getItem("token"),t=yield m.get(`${N}/blog/posts`,{headers:{Authorization:`Bearer ${e}`}});s(t.data||[])}catch(e){console.error("Error fetching posts:",e),s([])}finally{l(!1)}}),D=()=>{L({title:"",slug:"",excerpt:"",content:"",category:"Education",tags:"",status:"draft",featured:!1})},F=t.filter(e=>{const t=e.title.toLowerCase().includes(r.toLowerCase()),s="all"===w||e.status===w,a="all"===C||e.category===C;return t&&s&&a}),z={total:t.length,published:t.filter(e=>"published"===e.status).length,drafts:t.filter(e=>"draft"===e.status).length,featured:t.filter(e=>e.featured).length};return u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Blog Management"}),u.jsx("p",{className:"text-gray-400",children:"Create, edit, and manage your blog posts"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[u.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[u.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Total Posts"}),u.jsx("div",{className:"text-3xl font-bold text-white",children:z.total})]}),u.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[u.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Published"}),u.jsx("div",{className:"text-3xl font-bold text-green-500",children:z.published})]}),u.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[u.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Drafts"}),u.jsx("div",{className:"text-3xl font-bold text-yellow-500",children:z.drafts})]}),u.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[u.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Featured"}),u.jsx("div",{className:"text-3xl font-bold text-cyan-500",children:z.featured})]})]}),u.jsx("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 mb-6",children:u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsx("div",{className:"flex-1 min-w-[200px]",children:u.jsxs("div",{className:"relative",children:[u.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),u.jsx("input",{type:"text",placeholder:"Search posts...",value:r,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500"})]})}),u.jsxs("select",{value:w,onChange:e=>k(e.target.value),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[u.jsx("option",{value:"all",children:"All Status"}),u.jsx("option",{value:"published",children:"Published"}),u.jsx("option",{value:"draft",children:"Draft"})]}),u.jsxs("select",{value:C,onChange:e=>S(e.target.value),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[u.jsx("option",{value:"all",children:"All Categories"}),u.jsx("option",{value:"Education",children:"Education"}),u.jsx("option",{value:"Strategy",children:"Strategy"}),u.jsx("option",{value:"Lifestyle",children:"Lifestyle"}),u.jsx("option",{value:"Risk Management",children:"Risk Management"})]}),u.jsxs("button",{onClick:()=>{A(null),D(),E(!0)},className:"px-6 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg flex items-center gap-2 transition-colors",children:[u.jsx(h,{className:"w-5 h-5"}),"New Post"]})]})}),u.jsx("div",{className:"bg-slate-800 rounded-lg border border-slate-700 overflow-hidden",children:a?u.jsx("div",{className:"p-12 text-center text-gray-400",children:"Loading posts..."}):0===F.length?u.jsx("div",{className:"p-12 text-center text-gray-400",children:"No posts found"}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-slate-700",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Post"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Category"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Views"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-slate-700",children:F.map(e=>u.jsxs("tr",{className:"hover:bg-slate-700/50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{children:[e.featured&&u.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-yellow-500/20 text-yellow-500 rounded mb-2",children:"Featured"}),u.jsx("div",{className:"font-medium text-white",children:e.title}),u.jsx("div",{className:"text-sm text-gray-400 mt-1",children:e.excerpt}),e.tags&&e.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.slice(0,3).map((e,t)=>u.jsx("span",{className:"px-2 py-1 text-xs bg-slate-600 text-gray-300 rounded",children:e},t))})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:"px-3 py-1 text-sm bg-cyan-500/20 text-cyan-400 rounded",children:e.category})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:"px-3 py-1 text-sm rounded "+("published"===e.status?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"),children:e.status})}),u.jsx("td",{className:"px-6 py-4 text-gray-300",children:e.views||0}),u.jsx("td",{className:"px-6 py-4 text-gray-300 text-sm",children:new Date(e.created_at).toLocaleDateString()}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>(e=>i(null,null,function*(){var t,s;try{const t=localStorage.getItem("token"),s="published"===e.status?"draft":"published";yield m.put(`${N}/admin/posts/${e.id}`,{status:s},{headers:{Authorization:`Bearer ${t}`}}),alert(`Post ${"published"===s?"published":"unpublished"} successfully!`),O()}catch(a){console.error("Error toggling publish:",a),alert("Failed to change status: "+((null==(s=null==(t=a.response)?void 0:t.data)?void 0:s.message)||a.message))}}))(e),className:"p-2 rounded hover:bg-slate-600 "+("published"===e.status?"text-orange-400":"text-green-400"),title:"published"===e.status?"Unpublish":"Publish",children:"published"===e.status?u.jsx(b,{className:"w-5 h-5"}):u.jsx(f,{className:"w-5 h-5"})}),u.jsx("button",{onClick:()=>(e=>{A(e),L({title:e.title,slug:e.slug,excerpt:e.excerpt||"",content:e.content||"",category:e.category,tags:Array.isArray(e.tags)?e.tags.join(", "):"",status:e.status,featured:e.featured||!1}),E(!0)})(e),className:"p-2 text-blue-400 rounded hover:bg-slate-600",title:"Edit",children:u.jsx(y,{className:"w-5 h-5"})}),u.jsx("button",{onClick:()=>{return t=e.id,i(null,null,function*(){var e,s;if(confirm("Are you sure you want to delete this post?"))try{const e=localStorage.getItem("token");yield m.delete(`${N}/admin/posts/${t}`,{headers:{Authorization:`Bearer ${e}`}}),alert("Post deleted successfully!"),O()}catch(a){console.error("Error deleting post:",a),alert("Failed to delete post: "+((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||a.message))}});var t},className:"p-2 text-red-400 rounded hover:bg-slate-600",title:"Delete",children:u.jsx(j,{className:"w-5 h-5"})})]})})]},e.id))})]})})}),P&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-slate-800 rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"p-6 border-b border-slate-700 flex justify-between items-center sticky top-0 bg-slate-800",children:[u.jsx("h2",{className:"text-2xl font-bold text-white",children:$?"Edit Post":"Create New Post"}),u.jsx("button",{onClick:()=>{E(!1),A(null),D()},className:"text-gray-400 hover:text-white",children:u.jsx(x,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Title *"}),u.jsx("input",{type:"text",value:B.title,onChange:e=>{return t=e.target.value,void L(d(n({},B),{title:t,slug:t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}));var t},className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"Enter post title...",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Slug *"}),u.jsx("input",{type:"text",value:B.slug,onChange:e=>L(d(n({},B),{slug:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"post-url-slug",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Excerpt"}),u.jsx("textarea",{value:B.excerpt,onChange:e=>L(d(n({},B),{excerpt:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",rows:"3",placeholder:"Brief description..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Content *"}),u.jsx("textarea",{value:B.content,onChange:e=>L(d(n({},B),{content:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",rows:"10",placeholder:"Write your post content here...",required:!0})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),u.jsxs("select",{value:B.category,onChange:e=>L(d(n({},B),{category:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[u.jsx("option",{value:"Education",children:"Education"}),u.jsx("option",{value:"Strategy",children:"Strategy"}),u.jsx("option",{value:"Lifestyle",children:"Lifestyle"}),u.jsx("option",{value:"Risk Management",children:"Risk Management"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),u.jsxs("select",{value:B.status,onChange:e=>L(d(n({},B),{status:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",children:[u.jsx("option",{value:"draft",children:"Draft"}),u.jsx("option",{value:"published",children:"Published"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags (comma separated)"}),u.jsx("input",{type:"text",value:B.tags,onChange:e=>L(d(n({},B),{tags:e.target.value})),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-cyan-500",placeholder:"tag1, tag2, tag3"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",id:"featured",checked:B.featured,onChange:e=>L(d(n({},B),{featured:e.target.checked})),className:"w-4 h-4 text-cyan-600 bg-slate-700 border-slate-600 rounded focus:ring-cyan-500"}),u.jsx("label",{htmlFor:"featured",className:"ml-2 text-sm text-gray-300",children:"Mark as featured post"})]})]}),u.jsxs("div",{className:"p-6 border-t border-slate-700 flex justify-end gap-4 sticky bottom-0 bg-slate-800",children:[u.jsx("button",{onClick:()=>{E(!1),A(null),D()},className:"px-6 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Cancel"}),u.jsxs("button",{onClick:$?()=>i(null,null,function*(){var e,t;try{const e=localStorage.getItem("token"),t=d(n({},B),{tags:B.tags.split(",").map(e=>e.trim()).filter(Boolean)});yield m.put(`${N}/admin/posts/${$.id}`,t,{headers:{Authorization:`Bearer ${e}`}}),alert("Post updated successfully!"),E(!1),A(null),D(),O()}catch(s){console.error("Error updating post:",s),alert("Failed to update post: "+((null==(t=null==(e=s.response)?void 0:e.data)?void 0:t.message)||s.message))}}):()=>i(null,null,function*(){var t,s;try{const t=localStorage.getItem("token"),s=d(n({},B),{tags:B.tags.split(",").map(e=>e.trim()).filter(Boolean),author_id:e.id});yield m.post(`${N}/admin/posts`,s,{headers:{Authorization:`Bearer ${t}`}}),alert("Post created successfully!"),E(!1),D(),O()}catch(a){console.error("Error creating post:",a),alert("Failed to create post: "+((null==(s=null==(t=a.response)?void 0:t.data)?void 0:s.message)||a.message))}}),className:"px-6 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg flex items-center gap-2 transition-colors",children:[u.jsx(v,{className:"w-5 h-5"}),$?"Update Post":"Create Post"]})]})]})})]})}export{w as default};
