var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,s,l)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l,n=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&i(e,s,t[s]);if(l)for(var s of l(t))r.call(t,s)&&i(e,s,t[s]);return e},o=(e,l)=>t(e,s(l)),d=(e,t,s)=>new Promise((l,a)=>{var r=e=>{try{n(s.next(e))}catch(t){a(t)}},i=e=>{try{n(s.throw(e))}catch(t){a(t)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,i);n((s=s.apply(e,t)).next())});import{m as c,j as x,X as m}from"./index-yhEFMwPH.js";import{u,b as p}from"./react-vendor-DvHQdeg3.js";import h from"./AdminLayout-D1sULMUl.js";import{P as b}from"./plus-CxG6KMYb.js";import{U as g}from"./users-Do6K-tNM.js";import{T as j}from"./trending-up-3iDactr-.js";import{A as f}from"./activity-aCZTHeIp.js";import{T as v}from"./target-C6cGL-p0.js";import{D as y}from"./dollar-sign-Bset25RY.js";import{S as N}from"./search-BMoKb5gj.js";import{M as w}from"./mail-CXbczqp2.js";import{P as C}from"./phone-B3IVbRtw.js";import{C as S}from"./calendar-BM1ru7DU.js";import"./utils-BQl1bh9w.js";import"./notificationStore-D94npatz.js";import"./dateUtils-CNmF8-oe.js";import"./loader-DwLjhyqu.js";import"./bell-5rea5Nhk.js";import"./trash-2-Cd6OmhI8.js";import"./shield-xt4vHO8h.js";import"./layout-dashboard-CFjs078A.js";import"./chart-column-0G1aMFFb.js";import"./credit-card-Cc6XoJtC.js";import"./settings-Cuzzaant.js";import"./chevron-right-OCXL8LTO.js";import"./menu-CGKymVtE.js";function _(){const e=u(),[t,s]=p.useState([]),[l,a]=p.useState(!0),[r,i]=p.useState("table"),[_,k]=p.useState({status:"all",source:"all",search:""}),[L,z]=p.useState({total:0,new:0,contacted:0,qualified:0,converted:0}),[P,q]=p.useState(!1),[O,A]=p.useState({first_name:"",last_name:"",email:"",phone:"",company:"",status:"new",source:"website",score:50,budget:""});p.useEffect(()=>{E(),$()},[_]);const E=()=>d(null,null,function*(){try{a(!0);const e={};"all"!==_.status&&(e.status=_.status),"all"!==_.source&&(e.source=_.source),_.search&&(e.search=_.search);const t=yield c.getLeads(e);s(t.data.leads||[])}catch(e){console.error("Error fetching leads:",e)}finally{a(!1)}}),$=()=>d(null,null,function*(){try{const e=yield c.getStats();z(e.data)}catch(e){console.error("Error fetching stats:",e)}}),M=e=>e>=80?"text-green-600":e>=50?"text-yellow-600":"text-red-600",T={new:t.filter(e=>"new"===e.status),contacted:t.filter(e=>"contacted"===e.status),qualified:t.filter(e=>"qualified"===e.status),negotiation:t.filter(e=>"negotiation"===e.status),converted:t.filter(e=>"converted"===e.status)};return x.jsxs(h,{children:[x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold text-white",children:"CRM"}),x.jsx("p",{className:"text-slate-400 mt-1",children:"Manage your leads and customer relationships"})]}),x.jsxs("button",{onClick:()=>q(!0),className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all",children:[x.jsx(b,{size:20}),"Add Lead"]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[x.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-slate-400 text-sm",children:"Total Leads"}),x.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:L.total})]}),x.jsx("div",{className:"bg-blue-500/10 p-3 rounded-lg",children:x.jsx(g,{className:"text-blue-500",size:24})})]})}),x.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-slate-400 text-sm",children:"New"}),x.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:L.new})]}),x.jsx("div",{className:"bg-green-500/10 p-3 rounded-lg",children:x.jsx(j,{className:"text-green-500",size:24})})]})}),x.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-slate-400 text-sm",children:"Contacted"}),x.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:L.contacted})]}),x.jsx("div",{className:"bg-yellow-500/10 p-3 rounded-lg",children:x.jsx(f,{className:"text-yellow-500",size:24})})]})}),x.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-slate-400 text-sm",children:"Qualified"}),x.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:L.qualified})]}),x.jsx("div",{className:"bg-purple-500/10 p-3 rounded-lg",children:x.jsx(v,{className:"text-purple-500",size:24})})]})}),x.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-slate-400 text-sm",children:"Converted"}),x.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:L.converted})]}),x.jsx("div",{className:"bg-emerald-500/10 p-3 rounded-lg",children:x.jsx(y,{className:"text-emerald-500",size:24})})]})})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>i("table"),className:"px-4 py-2 rounded-lg transition-colors "+("table"===r?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:"Table View"}),x.jsx("button",{onClick:()=>i("pipeline"),className:"px-4 py-2 rounded-lg transition-colors "+("pipeline"===r?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:"Pipeline View"})]}),x.jsxs("div",{className:"flex gap-4",children:[x.jsxs("div",{className:"relative",children:[x.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),x.jsx("input",{type:"text",placeholder:"Search leads...",value:_.search,onChange:e=>k(o(n({},_),{search:e.target.value})),className:"pl-10 pr-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500"})]}),x.jsxs("select",{value:_.status,onChange:e=>k(o(n({},_),{status:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[x.jsx("option",{value:"all",children:"All Status"}),x.jsx("option",{value:"new",children:"New"}),x.jsx("option",{value:"contacted",children:"Contacted"}),x.jsx("option",{value:"qualified",children:"Qualified"}),x.jsx("option",{value:"negotiation",children:"Negotiation"}),x.jsx("option",{value:"converted",children:"Converted"}),x.jsx("option",{value:"lost",children:"Lost"})]}),x.jsxs("select",{value:_.source,onChange:e=>k(o(n({},_),{source:e.target.value})),className:"px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[x.jsx("option",{value:"all",children:"All Sources"}),x.jsx("option",{value:"website",children:"Website"}),x.jsx("option",{value:"referral",children:"Referral"}),x.jsx("option",{value:"agent",children:"Agent"}),x.jsx("option",{value:"social_media",children:"Social Media"})]})]})]}),l&&x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}),!l&&"table"===r&&x.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-lg overflow-hidden",children:x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"w-full",children:[x.jsx("thead",{className:"bg-slate-700/50",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Lead"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Contact"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Status"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Source"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Score"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Budget"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Assigned To"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Next Follow-up"})]})}),x.jsx("tbody",{className:"divide-y divide-slate-700",children:t.map(t=>{return x.jsxs("tr",{onClick:()=>e(`/admin/crm/${t.id}`),className:"hover:bg-slate-700/50 cursor-pointer transition-colors",children:[x.jsx("td",{className:"px-6 py-4",children:x.jsxs("div",{children:[x.jsxs("div",{className:"font-medium text-white",children:[t.first_name," ",t.last_name]}),t.company&&x.jsx("div",{className:"text-sm text-gray-400",children:t.company})]})}),x.jsx("td",{className:"px-6 py-4",children:x.jsxs("div",{className:"space-y-1",children:[x.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300",children:[x.jsx(w,{size:14}),t.email]}),t.phone&&x.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300",children:[x.jsx(C,{size:14}),t.phone]})]})}),x.jsx("td",{className:"px-6 py-4",children:x.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${l=t.status,{new:"bg-blue-100 text-blue-800",contacted:"bg-yellow-100 text-yellow-800",qualified:"bg-purple-100 text-purple-800",negotiation:"bg-orange-100 text-orange-800",converted:"bg-green-100 text-green-800",lost:"bg-red-100 text-red-800"}[l]||"bg-gray-100 text-gray-800"}`,children:t.status})}),x.jsx("td",{className:"px-6 py-4",children:x.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s=t.source,{website:"bg-indigo-100 text-indigo-800",referral:"bg-pink-100 text-pink-800",agent:"bg-cyan-100 text-cyan-800",social_media:"bg-purple-100 text-purple-800"}[s]||"bg-gray-100 text-gray-800"}`,children:t.source})}),x.jsx("td",{className:"px-6 py-4",children:x.jsx("span",{className:`font-semibold ${M(t.score)}`,children:t.score})}),x.jsx("td",{className:"px-6 py-4 text-sm text-white",children:t.budget?`$${t.budget.toLocaleString()}`:"-"}),x.jsx("td",{className:"px-6 py-4 text-sm text-white",children:t.assigned_user?t.assigned_user.name:"Unassigned"}),x.jsx("td",{className:"px-6 py-4 text-sm text-gray-300",children:t.next_follow_up?x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(S,{size:14}),new Date(t.next_follow_up).toLocaleDateString()]}):"-"})]},t.id);var s,l})})]})})}),!l&&"pipeline"===r&&x.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-lg p-6",children:x.jsx("div",{className:"flex gap-4 overflow-x-auto",children:Object.entries(T).map(([e,t])=>((e,t)=>x.jsx("div",{className:"flex-shrink-0 w-80",children:x.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[x.jsxs("div",{className:"flex items-center justify-between mb-4",children:[x.jsx("h3",{className:"font-semibold text-white capitalize",children:e}),x.jsx("span",{className:"bg-slate-600 text-white text-xs px-2 py-1 rounded-full",children:t.length})]}),x.jsx("div",{className:"space-y-3",children:t.map(e=>x.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-4 cursor-pointer hover:border-blue-500 transition-colors",children:[x.jsxs("div",{className:"font-medium text-white mb-2",children:[e.first_name," ",e.last_name]}),e.company&&x.jsx("div",{className:"text-sm text-gray-400 mb-2",children:e.company}),x.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300 mb-2",children:[x.jsx(w,{size:14}),e.email]}),e.phone&&x.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300 mb-2",children:[x.jsx(C,{size:14}),e.phone]}),x.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-slate-600",children:[x.jsxs("span",{className:`text-sm font-semibold ${M(e.score)}`,children:["Score: ",e.score]}),e.budget&&x.jsxs("span",{className:"text-sm text-gray-300",children:["$",e.budget.toLocaleString()]})]})]},e.id))})]})},e))(e,t))})})]}),P&&x.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsx("h2",{className:"text-2xl font-bold text-white",children:"Add New Lead"}),x.jsx("button",{onClick:()=>q(!1),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:x.jsx(m,{className:"text-gray-400",size:20})})]}),x.jsxs("form",{onSubmit:e=>d(null,null,function*(){var t,s,l,a;e.preventDefault();try{console.log("Creating lead with data:",O);const e=yield c.createLead(O);console.log("Lead created successfully:",e),q(!1),A({first_name:"",last_name:"",email:"",phone:"",company:"",status:"new",source:"website",score:50,budget:""}),E(),$()}catch(r){console.error("Error creating lead:",r),console.error("Error response:",null==(t=r.response)?void 0:t.data),console.error("Error status:",null==(s=r.response)?void 0:s.status),alert("Error creating lead: "+((null==(a=null==(l=r.response)?void 0:l.data)?void 0:a.error)||r.message))}}),className:"space-y-4",children:[x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"First Name *"}),x.jsx("input",{type:"text",required:!0,value:O.first_name,onChange:e=>A(o(n({},O),{first_name:e.target.value})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Last Name *"}),x.jsx("input",{type:"text",required:!0,value:O.last_name,onChange:e=>A(o(n({},O),{last_name:e.target.value})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email *"}),x.jsx("input",{type:"email",required:!0,value:O.email,onChange:e=>A(o(n({},O),{email:e.target.value})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone"}),x.jsx("input",{type:"tel",value:O.phone,onChange:e=>A(o(n({},O),{phone:e.target.value})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Company"}),x.jsx("input",{type:"text",value:O.company,onChange:e=>A(o(n({},O),{company:e.target.value})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),x.jsxs("select",{value:O.status,onChange:e=>A(o(n({},O),{status:e.target.value})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[x.jsx("option",{value:"new",children:"New"}),x.jsx("option",{value:"contacted",children:"Contacted"}),x.jsx("option",{value:"qualified",children:"Qualified"}),x.jsx("option",{value:"negotiation",children:"Negotiation"}),x.jsx("option",{value:"converted",children:"Converted"}),x.jsx("option",{value:"lost",children:"Lost"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Source"}),x.jsxs("select",{value:O.source,onChange:e=>A(o(n({},O),{source:e.target.value})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[x.jsx("option",{value:"website",children:"Website"}),x.jsx("option",{value:"referral",children:"Referral"}),x.jsx("option",{value:"agent",children:"Agent"}),x.jsx("option",{value:"social_media",children:"Social Media"})]})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Score (0-100)"}),x.jsx("input",{type:"number",min:"0",max:"100",value:O.score,onChange:e=>A(o(n({},O),{score:parseInt(e.target.value)})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Budget ($)"}),x.jsx("input",{type:"number",value:O.budget,onChange:e=>A(o(n({},O),{budget:e.target.value})),className:"w-full px-4 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500"})]})]}),x.jsxs("div",{className:"flex gap-4 mt-6",children:[x.jsx("button",{type:"button",onClick:()=>q(!1),className:"flex-1 px-6 py-3 bg-slate-700 text-white rounded-lg hover:bg-slate-600 transition-colors",children:"Cancel"}),x.jsx("button",{type:"submit",className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all",children:"Create Lead"})]})]})]})})]})}export{_ as default};
