var e=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(r,s,t)=>s in r?e(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,i=(e,r)=>{for(var s in r||(r={}))a.call(r,s)&&o(e,s,r[s]);if(t)for(var s of t(r))l.call(r,s)&&o(e,s,r[s]);return e},n=(e,t)=>r(e,s(t)),d=(e,r,s)=>new Promise((t,a)=>{var l=e=>{try{i(s.next(e))}catch(r){a(r)}},o=e=>{try{i(s.throw(e))}catch(r){a(r)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,o);i((s=s.apply(e,r)).next())});import{u as c,j as u,a as m,C as p,f as x}from"./index-BR0m5PO4.js";import{b}from"./react-vendor-ClcElYEu.js";import h from"./UserLayout-DpbtTElX.js";import{U as f}from"./upload-C-hL3deg.js";import{T as g}from"./trash-2-oLNZcVKm.js";import{U as v}from"./user-npSaNj6H.js";import{L as w}from"./lock-Bj-5lQ6B.js";import"./utils-DBSmTWZT.js";function y(){var e,r,s;const{user:t,updateUser:a}=c(),[l,o]=b.useState("personal"),y=b.useRef(null),[j,N]=b.useState({first_name:(null==t?void 0:t.first_name)||"",last_name:(null==t?void 0:t.last_name)||"",phone:(null==t?void 0:t.phone)||""}),[_,P]=b.useState(!1),[k,C]=b.useState({current_password:"",new_password:"",confirm_password:""}),[S,O]=b.useState(!1),[F,q]=b.useState(!1);return u.jsx(h,{children:u.jsxs("div",{className:"min-h-screen bg-slate-900",children:[u.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm border-b border-white/10",children:u.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[u.jsx("h1",{className:"text-3xl font-bold text-white",children:"Profile Settings"}),u.jsx("p",{className:"text-gray-400 mt-2",children:"Manage your account settings and preferences"})]})}),u.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-white/10 rounded-lg shadow-md mb-6 p-6",children:[u.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Profile Picture"}),u.jsxs("div",{className:"flex items-center gap-6",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white text-2xl font-bold overflow-hidden",children:(null==t?void 0:t.avatar_url)?u.jsx("img",{src:t.avatar_url,alt:"Profile",className:"w-full h-full object-cover"}):u.jsxs("span",{children:[null==(e=null==t?void 0:t.first_name)?void 0:e[0],null==(r=null==t?void 0:t.last_name)?void 0:r[0]]})}),F&&u.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})})]}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("button",{onClick:()=>{var e;null==(e=y.current)||e.click()},disabled:F,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-lg font-medium transition-all duration-200 flex items-center gap-2 disabled:opacity-50 shadow-lg shadow-blue-500/20",children:[u.jsx(f,{className:"w-4 h-4"}),"Upload New Photo"]}),(null==t?void 0:t.avatar_url)&&u.jsxs("button",{onClick:()=>d(null,null,function*(){var e,r;if(confirm("Are you sure you want to delete your profile picture?"))try{q(!0),yield x.deleteAvatar(),a({avatar_url:null}),alert("Profile picture deleted successfully!")}catch(s){alert((null==(r=null==(e=s.response)?void 0:e.data)?void 0:r.error)||"Failed to delete avatar")}finally{q(!1)}}),disabled:F,className:"px-4 py-2 bg-slate-700/50 hover:bg-red-500/20 text-gray-300 hover:text-red-400 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 disabled:opacity-50 border border-white/10",children:[u.jsx(g,{className:"w-4 h-4"}),"Delete"]})]}),u.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"JPG, PNG or GIF. Max size 5MB."})]}),u.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:e=>d(null,null,function*(){var r,s,t;const l=null==(r=e.target.files)?void 0:r[0];if(l)if(l.type.startsWith("image/"))if(l.size>5242880)alert("File size must be less than 5MB");else try{q(!0);const e=yield x.uploadAvatar(l);a({avatar_url:e.data.avatar_url}),alert("Profile picture updated successfully!")}catch(o){alert((null==(t=null==(s=o.response)?void 0:s.data)?void 0:t.error)||"Failed to upload avatar")}finally{q(!1)}else alert("Please select an image file")}),className:"hidden"})]})]}),u.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-white/10 rounded-lg shadow-md mb-6",children:[u.jsx("div",{className:"border-b border-white/10",children:u.jsxs("nav",{className:"flex -mb-px",children:[u.jsxs("button",{onClick:()=>o("personal"),className:"px-6 py-4 text-sm font-medium border-b-2 transition-all "+("personal"===l?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600"),children:[u.jsx(v,{className:"w-4 h-4 inline mr-2"}),"Personal Information"]}),u.jsxs("button",{onClick:()=>o("security"),className:"px-6 py-4 text-sm font-medium border-b-2 transition-all "+("security"===l?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-600"),children:[u.jsx(w,{className:"w-4 h-4 inline mr-2"}),"Security"]})]})}),u.jsxs("div",{className:"p-6",children:["personal"===l&&u.jsxs("form",{onSubmit:e=>d(null,null,function*(){var r,s;e.preventDefault();try{P(!0);const e=yield x.updateProfile(j);a(e.data.user),alert("Profile updated successfully!")}catch(t){alert((null==(s=null==(r=t.response)?void 0:r.data)?void 0:s.error)||"Failed to update profile")}finally{P(!1)}}),className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"First Name"}),u.jsx("input",{type:"text",value:j.first_name,onChange:e=>N(n(i({},j),{first_name:e.target.value})),className:"w-full px-4 py-2 bg-slate-700/50 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Last Name"}),u.jsx("input",{type:"text",value:j.last_name,onChange:e=>N(n(i({},j),{last_name:e.target.value})),className:"w-full px-4 py-2 bg-slate-700/50 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),u.jsx("input",{type:"email",value:null==t?void 0:t.email,disabled:!0,className:"w-full px-4 py-2 bg-slate-700/30 border border-white/10 rounded-lg text-gray-400 cursor-not-allowed"}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Email cannot be changed. Contact support if needed."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone Number"}),u.jsx("input",{type:"tel",value:j.phone,onChange:e=>N(n(i({},j),{phone:e.target.value})),className:"w-full px-4 py-2 bg-slate-700/50 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"+1234567890"})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",disabled:_,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-lg font-medium transition-all duration-200 disabled:opacity-50 shadow-lg shadow-blue-500/20",children:_?"Saving...":"Save Changes"})})]}),"security"===l&&u.jsxs("form",{onSubmit:e=>d(null,null,function*(){var r,s;if(e.preventDefault(),k.new_password===k.confirm_password)if(k.new_password.length<8)alert("Password must be at least 8 characters");else try{O(!0),yield x.changePassword({current_password:k.current_password,new_password:k.new_password}),alert("Password changed successfully!"),C({current_password:"",new_password:"",confirm_password:""})}catch(t){alert((null==(s=null==(r=t.response)?void 0:r.data)?void 0:s.error)||"Failed to change password")}finally{O(!1)}else alert("New passwords do not match")}),className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Password"}),u.jsx("input",{type:"password",value:k.current_password,onChange:e=>C(n(i({},k),{current_password:e.target.value})),className:"w-full px-4 py-2 bg-slate-700/50 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"New Password"}),u.jsx("input",{type:"password",value:k.new_password,onChange:e=>C(n(i({},k),{new_password:e.target.value})),className:"w-full px-4 py-2 bg-slate-700/50 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0,minLength:8}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Must be at least 8 characters"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirm New Password"}),u.jsx("input",{type:"password",value:k.confirm_password,onChange:e=>C(n(i({},k),{confirm_password:e.target.value})),className:"w-full px-4 py-2 bg-slate-700/50 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",disabled:S,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-lg font-medium transition-all duration-200 disabled:opacity-50 shadow-lg shadow-blue-500/20",children:S?"Changing...":"Change Password"})})]})]})]}),u.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-white/10 rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Account Status"}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"flex items-center justify-between p-3 bg-slate-700/30 rounded-lg border border-white/5",children:u.jsxs("div",{className:"flex items-center gap-3",children:[(null==t?void 0:t.is_verified)?u.jsx(m,{className:"w-5 h-5 text-green-400"}):u.jsx(p,{className:"w-5 h-5 text-yellow-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-white",children:"Email Verification"}),u.jsx("p",{className:"text-sm text-gray-400",children:(null==t?void 0:t.is_verified)?"Verified":"Not verified"})]})]})}),u.jsx("div",{className:"flex items-center justify-between p-3 bg-slate-700/30 rounded-lg border border-white/5",children:u.jsxs("div",{className:"flex items-center gap-3",children:["approved"===(null==t?void 0:t.kyc_status)?u.jsx(m,{className:"w-5 h-5 text-green-400"}):u.jsx(p,{className:"w-5 h-5 text-yellow-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-white",children:"KYC Verification"}),u.jsx("p",{className:"text-sm text-gray-400 capitalize",children:(null==(s=null==t?void 0:t.kyc_status)?void 0:s.replace("_"," "))||"Not submitted"})]})]})})]})]})]})]})})}export{y as default};
