var e=(e,s,t)=>new Promise((a,r)=>{var l=e=>{try{n(t.next(e))}catch(s){r(s)}},i=e=>{try{n(t.throw(e))}catch(s){r(s)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,i);n((t=t.apply(e,s)).next())});import{j as s,S as t,a,M as r}from"./index-BR0m5PO4.js";import{h as l,e as i,b as n,L as o}from"./react-vendor-ClcElYEu.js";import{L as c}from"./Layout-Cx0XYThF.js";import{S as d}from"./SEO-OBrxAOEF.js";import{a as m}from"./utils-DBSmTWZT.js";import{L as x}from"./loader-DSm_DJH7.js";import{T as p}from"./triangle-alert-wVvJFkZ9.js";import{A as u}from"./arrow-left-Dh6p0tMZ.js";import{U as h}from"./user-npSaNj6H.js";import{C as b}from"./calendar-BHR6i2qN.js";import{T as g}from"./tag-DCtXbrFC.js";import{C as j}from"./clock-CPtcaxWr.js";import"./log-out-DkBPYaep.js";import"./menu-oN7bJEN8.js";import"./mail-mtlpK5-x.js";import"./phone-X8PmW306.js";const f="https://marketedgepros.com/api/v1";function N(){const{ticketNumber:N}=l(),[y]=i(),v=y.get("email"),[w,k]=n.useState(null),[S,_]=n.useState(!0),[$,T]=n.useState(""),[C,F]=n.useState(""),[L,P]=n.useState(!1);n.useEffect(()=>{N&&v&&A()},[N,v]);const A=()=>e(null,null,function*(){var e,s;try{_(!0);const e=yield m.get(`${f}/support/tickets/${N}`,{params:{email:v}});k(e.data)}catch(t){T((null==(s=null==(e=t.response)?void 0:e.data)?void 0:s.error)||"Failed to load ticket")}finally{_(!1)}}),D=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});if(S)return s.jsx(c,{children:s.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:s.jsx(x,{className:"w-8 h-8 text-blue-500 animate-spin"})})});if($||!w)return s.jsx(c,{children:s.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(p,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Ticket Not Found"}),s.jsx("p",{className:"text-gray-400 mb-6",children:$||"The ticket you are looking for does not exist."}),s.jsxs(o,{to:"/support",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-xl font-semibold hover:bg-blue-600 transition-all",children:[s.jsx(u,{className:"w-5 h-5"}),"Back to Support"]})]})})});const R=(e=>{const s={open:{color:"bg-blue-500/10 text-blue-400 border-blue-500/30",icon:j,label:"Open"},in_progress:{color:"bg-yellow-500/10 text-yellow-400 border-yellow-500/30",icon:r,label:"In Progress"},waiting_customer:{color:"bg-purple-500/10 text-purple-400 border-purple-500/30",icon:p,label:"Waiting for You"},resolved:{color:"bg-green-500/10 text-green-400 border-green-500/30",icon:a,label:"Resolved"},closed:{color:"bg-gray-500/10 text-gray-400 border-gray-500/30",icon:a,label:"Closed"}};return s[e]||s.open})(w.status),U=R.icon;return s.jsxs(c,{children:[s.jsx(d,{title:`Ticket #${w.ticket_number} - ${w.subject}`,description:w.description}),s.jsxs("section",{className:"relative pt-32 pb-12 overflow-hidden bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:[s.jsxs("div",{className:"absolute inset-0",children:[s.jsx("div",{className:"absolute top-20 left-10 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl"}),s.jsx("div",{className:"absolute bottom-20 right-10 w-96 h-96 bg-purple-500/20 rounded-full blur-3xl"})]}),s.jsxs("div",{className:"relative max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs(o,{to:"/support",className:"inline-flex items-center gap-2 text-gray-300 hover:text-white mb-6 transition-colors",children:[s.jsx(u,{className:"w-5 h-5"}),"Back to Support"]}),s.jsx("div",{className:"flex items-start justify-between gap-4 mb-6",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsxs("span",{className:"font-mono text-lg text-gray-400",children:["#",w.ticket_number]}),s.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${R.color} flex items-center gap-1.5`,children:[s.jsx(U,{className:"w-4 h-4"}),R.label]})]}),s.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:w.subject}),s.jsxs("div",{className:"flex items-center gap-6 text-gray-400",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(h,{className:"w-4 h-4"}),w.name]}),s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(b,{className:"w-4 h-4"}),D(w.created_at)]}),s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(g,{className:"w-4 h-4"}),w.category]}),s.jsxs("span",{className:`flex items-center gap-2 ${(e=>{const s={low:"text-green-400",medium:"text-yellow-400",high:"text-orange-400",urgent:"text-red-400"};return s[e]||s.medium})(w.priority)}`,children:[s.jsx(p,{className:"w-4 h-4"}),w.priority.charAt(0).toUpperCase()+w.priority.slice(1)," Priority"]})]})]})})]})]}),s.jsx("section",{className:"py-12 bg-slate-900",children:s.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 mb-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx(h,{className:"w-5 h-5 text-blue-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"font-semibold text-white",children:w.name}),s.jsx("span",{className:"text-sm text-gray-500",children:D(w.created_at)})]}),s.jsx("div",{className:"text-gray-300 whitespace-pre-wrap",children:w.description})]})]})}),w.messages&&w.messages.length>0&&s.jsx("div",{className:"space-y-4 mb-6",children:w.messages.map(e=>s.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm border rounded-xl p-6 "+(e.is_staff?"border-green-500/30 bg-green-500/5":"border-slate-700"),children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 "+(e.is_staff?"bg-green-500/20":"bg-blue-500/20"),children:s.jsx(h,{className:"w-5 h-5 "+(e.is_staff?"text-green-400":"text-blue-400")})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:"font-semibold text-white",children:e.is_staff?"Support Team":e.name||w.name}),e.is_staff&&s.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 text-xs rounded-full border border-green-500/30",children:"Staff"}),s.jsx("span",{className:"text-sm text-gray-500",children:D(e.created_at)})]}),s.jsx("div",{className:"text-gray-300 whitespace-pre-wrap",children:e.message})]})]})},e.id))}),"closed"!==w.status&&s.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Add a Reply"}),s.jsxs("form",{onSubmit:s=>e(null,null,function*(){var e,t;if(s.preventDefault(),C.trim())try{P(!0),yield m.post(`${f}/support/tickets/${N}/messages`,{email:v,message:C,name:w.name}),F(""),yield A()}catch(a){alert((null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.error)||"Failed to send message")}finally{P(!1)}}),children:[s.jsx("textarea",{value:C,onChange:e=>F(e.target.value),placeholder:"Type your message here...",rows:6,className:"w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none mb-4",disabled:L}),s.jsx("button",{type:"submit",disabled:L||!C.trim(),className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl font-semibold hover:shadow-lg hover:shadow-blue-500/50 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:L?s.jsxs(s.Fragment,{children:[s.jsx(x,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):s.jsxs(s.Fragment,{children:[s.jsx(t,{className:"w-5 h-5"}),"Send Reply"]})})]})]}),"closed"===w.status&&s.jsxs("div",{className:"bg-gray-500/10 border border-gray-500/30 rounded-xl p-6 text-center",children:[s.jsx(a,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"This ticket is closed"}),s.jsx("p",{className:"text-gray-400",children:"If you need further assistance, please create a new support ticket."})]})]})})]})}export{N as default};
