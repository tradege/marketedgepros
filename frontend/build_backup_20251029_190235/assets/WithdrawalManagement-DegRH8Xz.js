var e=(e,s,a)=>new Promise((t,l)=>{var r=e=>{try{i(a.next(e))}catch(s){l(s)}},n=e=>{try{i(a.throw(e))}catch(s){l(s)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,n);i((a=a.apply(e,s)).next())});import{h as s,a,d as t,j as l}from"./index-CNgcY1MJ.js";import{b as r}from"./react-vendor-ClcElYEu.js";import{D as n}from"./DataTable-eR1RWmcN.js";import i from"./AdminLayout-DxemRxCh.js";import{C as d}from"./clock-BJfDzEOT.js";import{D as o}from"./dollar-sign-Dp8pNjLp.js";import{D as c}from"./download-DlhELNXw.js";import{E as m}from"./eye-D3H8eDhK.js";import"./utils-DBSmTWZT.js";import"./shield-DQGJDTHO.js";import"./log-out-Xj2_WwYs.js";import"./users-CjJDi9Iu.js";import"./trending-up-wYtPDKDL.js";import"./credit-card-Bopvyqcf.js";import"./chart-column-ByA6bMgK.js";import"./settings-Bd181c7H.js";import"./chevron-right-BN2u9AEN.js";function x(){var x,p,u;const[h,j]=r.useState([]),[g,b]=r.useState(!0),[v,f]=r.useState("all"),[y,N]=r.useState(!1),[w,F]=r.useState(null),[k,A]=r.useState(!1);r.useEffect(()=>{D()},[v]);const D=()=>e(null,null,function*(){try{b(!0);const e="all"!==v?{status:v}:{},a=yield s.get("/wallet/admin/withdrawals",{params:e});j(a.data.withdrawals||[])}catch(e){}finally{b(!1)}}),_=e=>l.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${{pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",processing:"bg-purple-100 text-purple-800",completed:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[e]||"bg-slate-700/50 text-gray-100"}`,children:e.charAt(0).toUpperCase()+e.slice(1)}),$=[{key:"id",label:"ID",render:e=>`#${e.id}`},{key:"user",label:"User",render:e=>{var s,a;return l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:(null==(s=e.user)?void 0:s.name)||"N/A"}),l.jsx("div",{className:"text-sm text-gray-400",children:(null==(a=e.user)?void 0:a.email)||"N/A"})]})}},{key:"amount",label:"Amount",render:e=>l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold",children:["$",parseFloat(e.amount).toFixed(2)]}),e.fee>0&&l.jsxs("div",{className:"text-xs text-gray-400",children:["Fee: $",parseFloat(e.fee).toFixed(2)]})]})},{key:"payment_method",label:"Method",render:e=>{var s;return l.jsx("span",{className:"capitalize",children:null==(s=e.payment_method)?void 0:s.replace("_"," ")})}},{key:"status",label:"Status",render:e=>_(e.status)},{key:"created_at",label:"Requested",render:e=>new Date(e.created_at).toLocaleDateString()},{key:"actions",label:"Actions",render:e=>l.jsx("button",{onClick:()=>{F(e),N(!0)},className:"text-blue-600 hover:text-blue-800 font-medium",children:l.jsx(m,{className:"w-5 h-5"})})}],S=[{label:"Total Pending",value:h.filter(e=>"pending"===e.status).length,icon:d,color:"yellow"},{label:"Total Amount Pending",value:`$${h.filter(e=>"pending"===e.status).reduce((e,s)=>e+parseFloat(s.amount),0).toFixed(2)}`,icon:o,color:"blue"},{label:"Completed Today",value:h.filter(e=>"completed"===e.status&&new Date(e.completed_at).toDateString()===(new Date).toDateString()).length,icon:a,color:"green"},{label:"Rejected",value:h.filter(e=>"rejected"===e.status).length,icon:t,color:"red"}];return l.jsx(i,{children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-white",children:"Withdrawal Management"}),l.jsx("p",{className:"mt-2 text-gray-300",children:"Manage and process withdrawal requests"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:S.map((e,s)=>{const a=e.icon;return l.jsx("div",{className:"bg-slate-800/50 rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-300",children:e.label}),l.jsx("p",{className:"text-2xl font-bold mt-1",children:e.value})]}),l.jsx("div",{className:`p-3 rounded-lg ${{yellow:"bg-yellow-100 text-yellow-600",blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",red:"bg-red-100 text-red-600"}[e.color]}`,children:l.jsx(a,{className:"w-6 h-6"})})]})},s)})}),l.jsx("div",{className:"bg-slate-800/50 rounded-lg shadow p-4",children:l.jsx("div",{className:"flex gap-2",children:["all","pending","approved","processing","completed","rejected"].map(e=>l.jsx("button",{onClick:()=>f(e),className:"px-4 py-2 rounded-lg font-medium transition-colors "+(v===e?"bg-blue-600 text-white":"bg-slate-700/50 text-gray-200 hover:bg-slate-700"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})}),l.jsx("div",{className:"bg-slate-800/50 rounded-lg shadow",children:l.jsx(n,{columns:$,rows:h})}),y&&w&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-slate-800/50 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold",children:"Withdrawal Details"}),l.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-300",children:"âœ•"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"border-b pb-4",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"User Information"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-300",children:"Name:"}),l.jsx("span",{className:"ml-2 font-medium",children:(null==(x=w.user)?void 0:x.name)||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-300",children:"Email:"}),l.jsx("span",{className:"ml-2 font-medium",children:(null==(p=w.user)?void 0:p.email)||"N/A"})]})]})]}),l.jsxs("div",{className:"border-b pb-4",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Amount Details"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-300",children:"Gross Amount:"}),l.jsxs("span",{className:"ml-2 font-medium",children:["$",parseFloat(w.amount).toFixed(2)]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-300",children:"Fee:"}),l.jsxs("span",{className:"ml-2 font-medium",children:["$",parseFloat(w.fee||0).toFixed(2)]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-300",children:"Net Amount:"}),l.jsxs("span",{className:"ml-2 font-medium text-green-600",children:["$",parseFloat(w.net_amount||w.amount).toFixed(2)]})]})]})]}),l.jsxs("div",{className:"border-b pb-4",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Payment Information"}),l.jsxs("div",{className:"text-sm space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-300",children:"Method:"}),l.jsx("span",{className:"ml-2 font-medium capitalize",children:null==(u=w.payment_method)?void 0:u.replace("_"," ")})]}),w.payment_details&&l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-300",children:"Details:"}),l.jsx("pre",{className:"ml-2 mt-1 p-2 bg-slate-900 rounded text-xs",children:JSON.stringify(w.payment_details,null,2)})]})]})]}),l.jsxs("div",{className:"border-b pb-4",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Status"}),l.jsxs("div",{className:"flex items-center gap-2",children:[_(w.status),l.jsxs("span",{className:"text-sm text-gray-300",children:["Requested: ",new Date(w.created_at).toLocaleString()]})]}),w.rejection_reason&&l.jsxs("div",{className:"mt-2 p-3 bg-red-50 rounded",children:[l.jsx("span",{className:"text-sm font-medium text-red-800",children:"Rejection Reason:"}),l.jsx("p",{className:"text-sm text-red-700 mt-1",children:w.rejection_reason})]})]}),l.jsxs("div",{className:"flex gap-3 pt-4",children:["pending"===w.status&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>{return a=w.id,e(null,null,function*(){var e,t;if(confirm("Are you sure you want to approve this withdrawal?"))try{A(!0),yield s.post(`/wallet/admin/withdrawals/${a}/approve`),alert("Withdrawal approved successfully"),D(),N(!1)}catch(l){alert((null==(t=null==(e=l.response)?void 0:e.data)?void 0:t.error)||"Failed to approve withdrawal")}finally{A(!1)}});var a},disabled:k,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium",children:[l.jsx(a,{className:"w-5 h-5 inline mr-2"}),"Approve"]}),l.jsxs("button",{onClick:()=>{return a=w.id,e(null,null,function*(){var e,t;const l=prompt("Please provide a reason for rejection:");if(l)try{A(!0),yield s.post(`/wallet/admin/withdrawals/${a}/reject`,{reason:l}),alert("Withdrawal rejected successfully"),D(),N(!1)}catch(r){alert((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||"Failed to reject withdrawal")}finally{A(!1)}});var a},disabled:k,className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 font-medium",children:[l.jsx(t,{className:"w-5 h-5 inline mr-2"}),"Reject"]})]}),("approved"===w.status||"processing"===w.status)&&l.jsxs("button",{onClick:()=>{return a=w.id,e(null,null,function*(){var e,t;const l=prompt("Please enter the transaction ID:");if(l)try{A(!0),yield s.post(`/wallet/admin/withdrawals/${a}/complete`,{transaction_id:l}),alert("Withdrawal marked as completed"),D(),N(!1)}catch(r){alert((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||"Failed to complete withdrawal")}finally{A(!1)}});var a},disabled:k,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium",children:[l.jsx(c,{className:"w-5 h-5 inline mr-2"}),"Mark as Completed"]})]})]})]})})})]})})}export{x as default};
